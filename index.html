<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Lambdas: Myths and Mistakes</title>

		<meta name="description" content="">
		<meta name="author" content="Richard Warburton">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="reveal.js/css/reveal.min.css">
		<link rel="stylesheet" href="reveal.js/css/theme/night.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">
		
        <link rel="stylesheet" href="extra.css">

		<!-- If the query includes 'print-pdf', use the PDF print sheet -->
		<script>
			document.write( '<link rel="stylesheet" href="reveal.js/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
		</script>

		<!--[if lt IE 9]>
		<script src="reveal.js/lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>
		<div class="reveal">
        <!-- possibly make slides bigger -->
			<div class="slides">

				<section>
					<h1>Lambdas: Myths and Mistakes</h1>
					<h3>by Richard Warburton</h3>

					<aside class="notes">
					</aside>
				</section>

				<section>
                    <blockquote>
                        Learning FP is so much more than just knowing what map/fold/filter/etc. do. 
                        It's more like getting good at Portal :)
                    </blockquote>
                    <p>@copumpkin</p>

					<aside class="notes">
                        Before we go into details ...
                        <br /> Explain quote
                        <br /> What does he really mean: idioms and technique are what is important.
					</aside>

				</section>
				
                <section>
                    <h2>Who am I?</h2>
                    <ul>
                        <li class="fragment roll-in">Currently work at jClarity</li>
                        <li class="fragment roll-in">PhD</li>
                        <li class="fragment roll-in">Adopt a JSR (Date and Time + Lambdas)</li>
                        <li class="fragment roll-in">Writing a book for O'Reilly Media on Lambda Expressions in Java 8.</li>
                    </ul>

                    <aside class="notes">
                        Taught Functional during PhD
                        <br />
					</aside>
				</section>

                <section>
                    <h1>Talk Structure</h1>
                    <ul>
                        <li>Background and Motivation</li>
                        <li>Introduction to Lambda Expressions</li>
                        <li>Beyond the Myths</li>
                        <li>Functional Thinking</li>
                    </ul>
                    <aside class="notes">
                        intro-ing in case there are people in the audience who don't know lambda expressions.
					</aside>
				</section>

                <section data-transition="linear" data-background="#007777" data-background-transition="slide">
                    <h1>Background and Motvation</h1>
                    <aside class="notes">
                        Why am I talking about this?
                        <br /> How did I get here?
                    </aside>
                </section>

                <section>
                    <h2>Lambda Expressions are coming in Java 8!</h2>
                    <aside class="notes">
                        Also massively improved collections library
                        <br /> Biggest change since generics
                        <br /> Language changes relatively small, library changes are the important thing
                        <br /> Language change enables library change
                    </aside>
                </section>

                <section>
                    <h2>Lots of discussion/debate</h2>
                    <aside class="notes">
                        Everyone has an opinion
                        <br /> That's healthy
                        <br /> Amount of irrelevant debate that goes on unhealthy, people shouting opinions
                        <br /> problems are hard, need to balance specialist implementor knowledge with mass-market usecases
                        <br /> lambda-dev was ineffective tool for discussion
                    </aside>
                </section>

                <section>
                    <h2>How can we help?</h2>
                    <p>Adopt-a-JSR</p>
                    <aside class="notes">
                        Community involvement and community driven standards.
                    </aside>
                </section>

                <section>
                    <h2>Adopt-a-JSR?</h2>
                    <ul>
                        <li>Community driven standards feedback</li>
                        <li class="fragment highlight-blue">Hackdays</li>
                        <li>Serve on Expert Groups</li>
                        <li>Initiated by Martijn Verburg</li>
                    </ul>
                    <aside class="notes">
                        Community involvement and community driven standards
                        <br /> Opinions of one person not so relevant
                        <br /> entire community is important - tough because people differ
                        <br /> report feedback to EG
                        <br /> trialled by James Gough and I on JSR-310.
                    </aside>
                </section>

                <section>
                    <h2>Some discussion unimportant</h2>
                    <p>Concrete Examples focus discussion</p>
                    <aside class="notes">
                        A lot of the mistakes people made were similar
                        <br /> similar to the mistakes I made, know several java champs similar mistake
                        <br /> Conclusion: other people not at hackdays
                        <br /> "We're not different you and I"
                    </aside>
                </section>

                <section data-transition="linear" data-background="#4d7e65" data-background-transition="slide">
                    <h1>Introduction to Lambda Expressions</h1>
                    <aside class="notes">
                    </aside>
                </section>

                <section data-transition="linear" data-background="#8c4738" data-background-transition="slide">
                    <h1>Beyond the Myths</h1>
                    <aside class="notes">
                    </aside>
                </section>

                <section>
                    <h2>Claim: Syntax is the most important thing about Lambda Expressions</h2>
                    <aside class="notes">
                    </aside>
                </section>

                <section>
                    <blockquote>
                        Yeah, I liked the # syntax proposal better, too.  One less character
                        to type!  :)
                    </blockquote>
                    <aside class="notes">
                        Referring to a preference over ::
                    </aside>
				</section>

                <section>
                    <blockquote>
                        Have you considered 'default null'?  It will save a keyword
                    </blockquote>
                    <aside class="notes">
                        asking for things being too short at the expense of readability.
                    </aside>
				</section>

                <section>
                    <blockquote>
                        How about a single punctuation mark, currently unused, as syntax sugar
                        for "()->".
                    </blockquote>
                    <aside class="notes">
                        Extreme operator usage.
                    </aside>
				</section>

                <section>
                    <blockquote>
                        (_, _) -> _ + _
                    </blockquote>

                    <br />

                    <blockquote>
                        This is starting to look like risque ASCII art :)
                    </blockquote>
                    <aside class="notes">
                        Joke Slide: absurdism
                    </aside>
				</section>

                <section>
                    <h2>Its a Myth!</h2>
                    <img src="imgs/nessie.jpg" />
                    <aside class="notes">
                        People asked about the syntax but very little explanation and only a few examples were required.
                        <br /> Vast amounts more thought going into type inference, type system changes and overload resolution.
                    </aside>
                </section>

                <section>
                    <h2>Claim: Syntax is irrelevant</h2>
                    <img class="fragment" src="imgs/nessie-2.jpg" />
                    <aside class="notes">
                        Whilst token substitution not important, people did get tripped up on syntax.
                    </aside>
                </section>

                <section>
                    <pre><code data-trim>
// Originally invalid
Stream.of(1, 2, 3)
      .forEach(x -> System.out.println(x));

// Required extra ;
Stream.of(1, 2, 3)
      .forEach(x -> System.out.println(x););
                    </code></pre>
                    <aside class="notes">
                        Tripped up loads of people
                        <br />Incredibly confusing compiler message
                        <br />Issue was that println returned void and was a statement
                        <br />Need a ; at the end of statements
                        <br />thankfully fixed after being reported
                    </aside>
                </section>

                <section>
                    <h2>Difference between expectations</h2>
                    <ul>
                        <li>Many language features <strike>stolen!</strike> adapted</li>
                        <li>Missing Features
                        <ul>
                            <li>Stronger Type System</li>
                            <li>Tuples</li>
                            <li>List construction syntax</li>
                        </ul>
                        <li>Prior FP experience generated requrests for features.</li>
                    </ul>
                    <aside class="notes">
                        stolen vs adapted: frame of reference.  Reality is there's a lot of work to bring changes into Java 8.
                        <br /> Point is no Java dev I spoke to ever complained about the lack of higher kinded types.
                        <br /> Not a good or bad feature change, just a different perspective.
                    </aside>
                </section>

                <section>
                    <h2>Framing Effect</h2>
                    <p>Different reactions depending on whether something is presented as a loss or a gain.</p>
                    <aside class="notes">
                        Basic Psychology
                        <br /> "Prospect theory shows that a loss is more significant than the equivalent gain"
                        <br /> Coming from Scala: you might expect tuples and higher kinded types
                        <br /> Coming from Java 7 you're happy with what's provided
                        <br /> Also results in the general reaction from Scala devs that they aren't coming back
                    </aside>
                </section>
                
                <section>
                    <h2>Observation: Very little TDD</h2>
                    <ul>
                        <li>Only a couple of developers used TDD</li>
                        <li>Maybe a reflection on general TDD</li>
                        <li>Maybe unfamiliarity with testing functional code</li>
                    </ul>
                    <aside class="notes">
                        might be part of a hackday environment: experimentation not reliable code
                        <br /> some people tried to do TDD
                        <br /> theoretically functional code easier to test
                        <br /> specification based testing
                    </aside>
                </section>

                <section>
                    <h2>How do I test this?</h2>
                    <pre><code>
list.stream()
    .map(x -> 1.0 / Math.ceil(1 + Math.pow(x) + Math.atan2(0, x)))
    .collect(toList());
                    </code></pre>
                    <aside class="notes">
                        Issue is that lambda expressions aren't reference-able.
                        <br /> Say your lambda expression interacts with a database: how do you mock it?
                        <br /> Anyone spot the subtle bug?
                        <br /> atan2(0,0) is mathematically undefined, Java gives an answer
                    </aside>
                </section>

                <section>
                    <h2>Approach 1: Test whole function</h2>
                    <ul>
                        <li>Don't test the lambda</li>
                        <li>Test the method its surrounded by</li>
                        <li>Works well for simple lambdas</li>
                    </ul>
                    <aside class="notes">
                    </aside>
                </section>

                <section>
                    <h2>Approach 2: Extract Method</h2>
                    <pre><code>
double complexFunction(double x) {
    return 1.0 / Math.ceil(1 + Math.pow(x) + Math.atan2(0, x));
}

list.stream()
    .map(this::complexFunction)
    .collect(toList());
                    </code></pre>
                    <aside class="notes">
                        extract your lambda out to a function if its complex.
                        <br /> Still get the code reuse and stream functionality through method references
                        <br /> Method references really help testability for things like this.
                    </aside>
                </section>

                <section>
                    <h2>Mistake: debugging</h2>
                    <pre><code>
list.stream()
    .filter(filteringFunction)
    .map(mappingFunction)
    .collect(toList());
                    </code></pre>
                    <aside class="notes">
                        Issue is understanding intermediate values.
                    </aside>
                </section>

                <section>
                    <h2>peek</h2>
                    <pre><code>
list.stream()
    .filter(filteringFunction)
    .peek(e -> System.out.println("Filtered value: " + e));
    .map(mappingFunction)
    .peek(e -> {});
    .collect(toList());
                    </code></pre>
                    <aside class="notes">
                        could also be logging output or debugger breakpoint.
                        <br /> similar to the unix tee program.  Hands up.
                    </aside>
                </section>

                <!-- MAYBE: -->
                <!-- mention flatmap redesign? -->
                <!-- Pulling into local variables vs chaining -->

                <!--
TODO:
overload resolution + compiler errors
consider example of comparator
-->

                <section>
                    <h2>Summary</h2>
                    <ul>
                        <li>Syntax important, but not in the way people think</li>
                        <li>New approaches for debugging and testing</li>
                        <li>Take care of overloads and compiler error messages</li>
                    </ul>
                    <aside class="notes">
                    </aside>
                </section>

                <section data-transition="linear" data-background="#4d7e65" data-background-transition="slide">
                    <h1>Functional Thinking</h1>
                    <aside class="notes">
                        Say what I mean
                        <br /> look at a couple of examples
                        <br /> try and think of solutions
                    </aside>
                </section>

                <section>
                    <h1>What do I mean by Functional Thinking?</h1>
                    <p>Thinking in terms of the input:output relationship and not a sequence of steps</p>
                    <aside class="notes">
                        What is it?
                        <br /> Functional means different things to different communities
                        <br /> clojure: immutability, haskell: purity + monads, scala: a series of nouns which can be used for trolling.
                        <br /> Biggest issue that I saw: easy to develop and understand, but takes a bit of practise.
                        <br /> In the same way that patterns such as SOLID exist in OOP and take a while to develop.
                    </aside>
                </section>

                <section>
                    <h2>First code that people write</h2>
                    <pre><code>
List<Integer> numbers = Arrays.asList(1, 2, 3);
numbers.forEach(x -> {
    System.out.println(x);
});
                    </pre></code>
                    <aside class="notes">
                        Pretty consistent in understanding internal vs external iteration.
                        <br /> not initially trying higher order functions.
                    </aside>
                </section>

                <section>
                    <h2>Example Problem</h2>
                    <p>Count the number of instances of each word in a document.</p>
                    <aside class="notes">
                        Required understanding of the collectors abstraction.
                        <br /> Given a stream of words as input.
                    </aside>
                </section>

                <section>
                    <h2>Example Problem</h2>
                    <img src="imgs/stephen-colebourne.jpg" />
                    <aside class="notes">
                        <br /> emphasize he’s a really good programmer, conference speaker, jodatime author
                        <br /> mention annecdote with stuart marks' laptop
                    </aside>
                </section>

                <section>
                    <h2>Ideal Solution (Today)</h2>
                    <pre><code>
reader.lines()
      .flatMap(s -> Stream.of(s.split(" ")))
      .collect(groupingBy(s -> s, counting()));

// Map entries for "dad"
// [ "dad", "dad", "dad" ] => [1, 1, 1] => 3
                    </pre></code>
                    <aside class="notes">
                        Explain code
                        <br /> explain the breakdown
                        <br /> emphasize the downstream collectors
                    </aside>
                </section>

                <section>
                    <h2>Ideal Solution (At the time)</h2>
                    <pre><code>
reader.lines()
      .flatMap(s -> Stream.of(s.split(" ")))
      .collect(groupingBy(s -> s, reducing(s -> 1, Integer::sum)));
                    </pre></code>
                    <aside class="notes">
                        Counting not originally there.
                        <br /> Subsequently added.
                        <br /> People not only failed to get there, but also failed to understand the solution when presented
                    </aside>
                </section>

                <section>
                    <h2></h2>
                    <p></p>
                    <aside class="notes">
                    </aside>
                </section>

                <section>
                    <h2>Summary</h2>
                    <ul>
                        <li>Functional Thinking the biggest 'skill gap'</li>
                        <li>Not Java specific at all</li>
                        <li>Requires Practise</li>
                    </ul>
                    <aside class="notes">
                        Recognising the problem is the first step
                    </aside>
                </section>

                <section>
                    <h1>Conclusions</h1>

<img src="imgs/steve-balmer-with-the-new-microsoft-surface-tablet.jpg" />

                    <ul>
                    </ul>

                    <aside class="notes">
                    </aside>
                </section>

                <section>
                    <h1>Questions?</h1>
                    <p>@RichardWarburto<p>
                    <p><a href="http://insightfullogic.com">http://insightfullogic.com</a></p>
                    <p><a href="https://github.com/RichardWarburton/">https://github.com/RichardWarburton/</a></p>
                </section>

            </div>
        </div>

        <script src="reveal.js/lib/js/head.min.js"></script>
        <script src="reveal.js/js/reveal.min.js"></script>

        <script>
            // Full list of configuration options available here:
            // https://github.com/hakimelreveal.js#configuration
            Reveal.initialize({
                controls: true,
                progress: true,
                history: true,
                center: true,

                theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
                transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

                // Optional libraries used to extend on reveal.js
                dependencies: [
                    { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
                    { src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
                    // { src: 'plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; } }
                    // { src: 'plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
                ]
            });
        </script>

</body>
</html>

